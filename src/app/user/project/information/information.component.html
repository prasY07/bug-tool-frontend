<div class="container">
  <section class="mt-3 bug-add-btn">
    <button class="btn btn-primary" (click)="addBug()">Add Bug</button>
  </section>

  <app-add-bug [isOpen]="isModalOpen" [projectId]="projectId" (close)="handleCloseModal()"></app-add-bug>
  <div class="mt-2">
    <div class="col-12 card shadow-lg" style="height:max-content; padding: 0;">
      <div class="card-header">
        Project Information
      </div>
      <div class="card-body row">
        <div class="col-6">
          <p><b>Project Name:</b> {{projectDeatils.name}}</p>
        </div>
        <div class="col-6">
          <p><b>Status:</b> <span style="margin-left:5px;" [innerHTML]="projectDeatils.status | projectStatus"></span></p>
        </div>
        <div class="col-6">
          <p><b>Deadline:</b> {{projectDeatils.d_date | customDateFormat}}</p>
        </div>
        <div class="col-6">
          <div><strong>Assign Member:</strong>
            <div class="members-container-inline">
              <div *ngFor="let member of projectDeatils.members" class="member-avatar" title="{{ member.name }}">
                {{ member.name.charAt(0).toUpperCase() }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


  <div class="mt-3">
    <div class="row">
      <div class="col-12">
        <h2 class="bug-heading">Bugs</h2>
      </div>
      <div class="row" *ngIf="bugs.length > 0; else noBugs">
      <div class="col-6 mb-3" *ngFor="let bug of bugs">
        <div class="card p-3 shadow-sm">
          <div class="bug-section d-flex justify-content-between align-items-center">
            <h5 class="card-title text-truncate" title="{{ bug.title }}">
              {{ bug.title }}
            </h5>
            <button class="btn btn-link p-0" (click)="showBugDetails(bug)">
              <i class="bi bi-info-circle"></i>
            </button>
          </div>
          <p class="card-text"><strong>Assigned By:</strong> <span class="bug_assigned">{{ bug.assigned_by.name }}</span></p>

          <div class="">
            <p><strong>Assigned To:</strong></p>
            <ul class="assigned-to-list">
              <li *ngFor="let member of bug.assigned_to" class="member-avatar" title="{{ member.name }}">
                {{ member.name.charAt(0).toUpperCase() }}
              </li>
            </ul>
          </div>
          <div class="card-footer text-muted">

          <b>Bug Status: </b>
                <span *ngIf="isLoggedInUserAssigned(bug)">
                <select class="bug-status" >
                <option value="">Open</option>
                <option value="">Inprogress</option>
                <option value="">Completed</option>
              </select>
            </span>
            <span *ngIf="!isLoggedInUserAssigned(bug)">
              {{bug.status}}
            </span>
          </div>
        </div>
      </div>
    </div>
      <ng-template #noBugs>
        <div class="col-12 text-center">
          <p>No bugs found.</p>
        </div>
      </ng-template>
    </div>
  </div>


</div>
